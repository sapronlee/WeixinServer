# = require angular/angular
# = require angular/angular-locale_zh-cn

# = require angularjs/rails/resource
# = require angular/libs/ng-table
# = require angular/libs/ng-table-params
# = require angular/libs/ui-bootstrap-tpls-0.4.0
# = require angular/libs/ui-utils
# = require angular/libs/angular-strap
# = require angular/libs/lb-breadcrumbs
# = require angular/libs/jquery.fileupload

# = require angular/services
# = require angular/controllers
# = require angular/directives

window.weixin = angular.module('weixin', ['weixin.services', 'weixin.controllers', 'weixin.directives', 'ngTable', 'ui.bootstrap', 'ui.utils', '$strap.directives', 'lbBreadcrumbs', 'blueimp.fileupload'])

window.weixin.config ['$httpProvider', ($httpProvider) ->
  $httpProvider.defaults.headers.common['X-CSRF-Token'] = document.getElementsByName("csrf-token")[0].content
  $httpProvider.defaults.headers.common['Accept'] = "application/json"
]

window.weixin.config ['$routeProvider', '$locationProvider', ($routeProvider, $locationProvider) ->
  # $locationProvider.html5Mode(true)
  $routeProvider
  .when '/',
    templateUrl: '<%= asset_path("home/index.html") %>',
    controller: 'HomeController'
  .when '/weixin/replies',
    templateUrl: '<%= asset_path("weixin/replies/index.html") %>',
    controller: 'WeixinRepliesController'
  .when '/weixin/replies/new',
    templateUrl: '<%= asset_path("weixin/replies/new.html") %>',
    controller: 'NewWeixinReplyController'
  .when '/resources/audios',
    templateUrl: '<%= asset_path("resources/audios/index.html") %>',
    controller: 'AudiosController'
  .when '/resources/articles',
    templateUrl: '<%= asset_path("resources/articles/index.html") %>',
    controller: 'ArticlesController'
  .when '/resources/articles/new',
    templateUrl: '<%= asset_path("resources/articles/new.html") %>',
    controller: 'NewArticleController'
  .otherwise 
    redirectTo: '/'
]